@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .

PREFIX sin3: <https://notation3.org/sin3#>



{?s ("^" ?p) ?o }<={?p sin3:isVariable false.  {?s ("^" ?p) ?o } sin3:track ()  }.

{?s (?p1 "/" ?p2) ?o}<={?p1 sin3:isVariable false. {?s (?p1 "/" ?p2) ?o} sin3:track () }.

{?s (?p1 "|" ?p2) ?o}<={?p1 sin3:isVariable false. {?s (?p1 "|" ?p2) ?o} sin3:track () }.



{?s (?p "*") ?o}<={?p sin3:isVariable false.  {?s (?p "*") ?o} sin3:track ()}.

{?s (?p "+") ?o}<={?p sin3:isVariable false.  {?s (?p "+") ?o} sin3:track ()}.



{?s (?p "?") ?o}<={?p sin3:isVariable false.  {?s (?p "?") ?o} sin3:track ()}.

# ("!" ?p) ("!" (?p1 ... ?pn)) ("!" (?p1 ... ("^"?pn))
{?s ("!" ?x) ?o}<={?x sin3:isVariable false. {?s ("!" ?x) ?o} sin3:track () }.


####



{{?s ("^" ?p) ?o } sin3:track ?list }<={?p sin3:isVariable false.  { ?o ?p ?s.} sin3:track ?list  }.

{{?s (?p1 "/" ?p2) ?o} sin3:track ?list }<={?p1 sin3:isVariable false.  {?s ?p1 ?o1} sin3:track ?list. {?o1 ?p2 ?o.} sin3:track ?list}.

{{?s (?p1 "|" ?p2) ?o} sin3:track ?list }<={?p1 sin3:isVariable false.  {?s ?p1 ?o} sin3:track ?list}.
{{?s (?p1 "|" ?p2) ?o} sin3:track ?list }<={?p1 sin3:isVariable false.  {?s ?p2 ?o} sin3:track ?list}.

{{?s (?p "*") ?s} sin3:track ?list}<={?p sin3:isVariable false.  ?s ?p1 ?o. ?p1 log:rawType log:Other. }.
{{?s (?p "*") ?s} sin3:track ?list}<={?p sin3:isVariable false.  ?o ?p1 ?s.  ?p1 log:rawType log:Other. }.
{{?s (?p "*") ?o} sin3:track ?list}<={?p sin3:isVariable false.  { ?s (?p "+") ?o} sin3:track ?list.}.

{{?s (?p "+") ?o} sin3:track ?list}<={?p sin3:isVariable false.  ?s ?p ?o}.
{{?s (?p "+") ?o} sin3:track ?list}<={ ?p sin3:isVariable false.   ?s ?p ?o1.   ?o1 list:notMember ?list.
(?o1 ?list) list:append ?list2.
{?o1 (?p "+") ?o. } sin3:track ?list2.
}.

{?s (?p "?") ?s}<={ ?p sin3:isVariable false. }.
{?s (?p "?") ?o}<={?p sin3:isVariable false.  ?s ?p ?o}.

# ("!" ?p) ("!" (?p1 ... ?pn)) ("!" (?p1 ... ("^"?pn))
{{?s ("!" ("^" ?p )) ?o} sin3:track ?list }<={?p sin3:isVariable false. ?o ?p1 ?s. ?p log:notEqualTo ?p1}.
{{?s ("!" ?list ) ?o} sin3:track ?list }<={?list log:rawType rdf:List.  
?s ?p ?o.
?p log:notEqualTo ("^" ?p3).
?list list:notMember ?p.
}.
{{?s ("!" ?list ) ?o} sin3:track ?list}<={?list log:rawType rdf:List.  
?o ?p ?s.
?list list:notMember ("^" ?p).
 }.
{{?s ("!" ?p ) ?o} sin3:track ?list }<={?p sin3:isVariable false. ?s ?p2 ?o. ?p2 log:notEqualTo ?p}.

{{?s ?p ?o} sin3:track ?list}<={?p log:rawType log:Other. ?s ?p ?o}.

# is variable
{?p sin3:isVariable false}<={?p log:rawType ?t. ?t log:notEqualTo  log:ForAll.}.
